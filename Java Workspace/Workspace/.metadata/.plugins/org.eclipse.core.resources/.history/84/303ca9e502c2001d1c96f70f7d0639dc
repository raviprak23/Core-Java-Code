package Jdbc_project; 
 
import java.sql.Connection; 
import java.sql.ResultSet; 
import java.sql.ResultSetMetaData; 
import java.sql.Statement; 
import java.util.Scanner; 
 
public class RetrieveData { 
 Connection conn = null; 
 Statement stmt = null; 
 String tableName; 
 Scanner scanner = new Scanner(System.in); 
 Validate validate = new Validate(); 
 
 public RetrieveData(Connection conn, Statement stmt) { 
  this.conn = conn; 
  this.stmt = stmt; 
 } 
 
 public void retrieveDetails() throws Exception { 
 
  try { 
   System.out.print("Enter table name to retrieve data: "); 
   tableName = validate.getValidData(); 
   String retrievesql = "SELECT * FROM " + tableName; 
   ResultSet rs = stmt.executeQuery(retrievesql); 
   System.out.println("Displaying table details:"); 
   ResultSetMetaData rsmd = rs.getMetaData(); 
   int columnsNumber = rsmd.getColumnCount(); 
 
   while (rs.next()) { 
    for (int i = 1; i <= columnsNumber; i++) { 
     if (i > 1) 
      System.out.print(",  "); 
     String columnValue = rs.getString(i); 
     System.out.print(rsmd.getColumnName(i) + " : " + columnValue); 
    } 
    System.out.println(""); 
   } 
  } catch (Exception e) { 
   System.out.println("Table doesnt exists, please enter valid table name"); 
  } 
 
 } 
}